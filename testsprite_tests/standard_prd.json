{
  "meta": {
    "project": "Semantis AI Semantic Caching Platform",
    "date": "2025-10-29",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Semantis AI provides a developer-first, zero-infrastructure semantic caching platform designed to reduce cost and latency for large language model (LLM) applications by caching semantically equivalent prompts and reusing answers. It offers OpenAI-compatible APIs, multi-tenant isolation, adaptive semantic similarity thresholds, TTLs, observability, and security via API key authentication.",
  "core_goals": [
    "Deliver a developer-friendly caching layer that integrates seamlessly with existing LLM workflows using OpenAI-compatible endpoints.",
    "Achieve 50-70% cache hit rates on typical support and retrieval-augmented generation (RAG) workloads within 30 days of deployment.",
    "Provide transparent observability including metrics like hit ratios, latency, similarity scores, and cost savings.",
    "Support multi-tenant data isolation and secure access via tenant-scoped API keys.",
    "Offer pluggable vector indexing backends and adaptive semantic similarity thresholds per tenant to optimize cache effectiveness."
  ],
  "key_features": [
    "OpenAI-compatible chat completions endpoint (POST /v1/chat/completions) and simplified GET /query endpoint with semantic caching and hybrid exact+semantic cache strategy.",
    "Exact cache indexed by normalized prompts and models for fast lookups.",
    "Semantic cache using embedding models (text-embedding-3-large, fallback bge-large, E5) and FAISS vector search with cosine similarity to detect semantic equivalence.",
    "Adaptive threshold (Î¸_client) per tenant to balance cache hit ratio between 0.55 and 0.85 by adjusting similarity threshold based on request feedback every 100 queries.",
    "TTL and cache invalidation policies, including default 7-day TTL extended to 30 days on popular cache entries, with admin controls for invalidation.",
    "Multi-tenant isolation enforced via API key bearer tokens and namespace separation for data, vectors, and logs.",
    "Comprehensive metrics and logging endpoints including cache hit ratios, latency percentiles (p50/p95), semantic hits, misses, and token cost savings.",
    "Health and readiness endpoints for service status monitoring.",
    "Frontend dashboard with query playground, metrics visualization, logs viewer, tenant settings, and quick-start docs and SDKs for Python and Node.js.",
    "Robust security features: HTTPS only, rate limiting per tenant, input size limiting, CORS allowlisting, and encrypted secrets management."
  ],
  "user_flow_summary": [
    "Developers obtain tenant-specific API keys in Bearer token format and authenticate requests to the semantic cache API.",
    "They send chat completion requests or simple query GET requests with prompts modeled after OpenAI API format.",
    "The service first attempts exact cache lookup; if missed, it performs semantic vector search with FAISS to find similar cached responses above the tenant's similarity threshold.",
    "If a semantic hit occurs, the cached answer is returned along with metadata on hit type, similarity score, and latency.",
    "If no suitable cache hit, the request is forwarded to the configured LLM provider and the new response cached for future reuse.",
    "Developers can view real-time usage metrics, hit ratios, latency, cache events, and cost savings via the frontend dashboard.",
    "Tenants can adjust similarity thresholds and TTL settings via the settings page to optimize caching behavior.",
    "Admin users can invalidate cached entries or adjust thresholds through protected endpoints in future enterprise versions.",
    "Health checks and metrics endpoints provide observability and operational status.",
    "SDKs handle retries and network errors transparently for seamless integration."
  ],
  "validation_criteria": [
    "All API requests return structured meta information specifying hit type (exact, semantic, miss) and metrics including similarity and latency.",
    "Exact cache hits occur for identical prompts within a session.",
    "Semantic cache hits occur for paraphrased queries meeting or exceeding the tenant-specific similarity threshold.",
    "Logs capture every request and error accurately with rotation policies and optionally external shipping.",
    "Metric endpoints report up-to-date and accurate counters consistent with log samples.",
    "Cache invalidation endpoints remove entries safely without causing service crashes or index corruption.",
    "Adaptive threshold mechanism adjusts similarity parameter correctly based on traffic and target hit ratios within specified windows.",
    "Frontend playground shows real-time query results with latency, hit type, and similarity visible.",
    "Metrics and logs update continuously with new cache events and usage data.",
    "Settings changes persist and reflect in subsequent queries to influence caching behavior.",
    "SDKs and examples execute successfully with relevant error handling and retry logic.",
    "Health endpoint returns service status and version information consistently.",
    "Security controls including API key validation, rate limiting, input size limits, and HTTPS enforcement function as expected."
  ],
  "code_summary": {
    "tech_stack": [
      "Python",
      "FastAPI",
      "FAISS",
      "OpenAI",
      "Uvicorn"
    ],
    "features": [
      {
        "name": "Health Check",
        "description": "Returns service health status",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "openapi": "3.1.0",
          "info": {
            "title": "Semantis AI Semantic Cache API",
            "description": "A semantic caching service for LLM apps. Authentication via Bearer API keys formatted as `Bearer sc-{tenant}-{anything}`.",
            "version": "0.1.0"
          },
          "components": {
            "securitySchemes": {
              "BearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "sc-{tenant}-{anything}",
                "description": "Use tenant-based auth keys (e.g., Bearer sc-test-local)"
              }
            }
          },
          "security": [
            {
              "BearerAuth": []
            }
          ],
          "paths": {
            "/health": {
              "get": {
                "summary": "Health",
                "operationId": "health_health_get",
                "responses": {
                  "200": {
                    "description": "Successful Response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "status": {
                              "type": "string",
                              "example": "ok"
                            },
                            "service": {
                              "type": "string",
                              "example": "semantic-cache"
                            },
                            "version": {
                              "type": "string",
                              "example": "0.1.0"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Cache Metrics",
        "description": "Returns cache performance metrics for a tenant",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "paths": {
            "/metrics": {
              "get": {
                "summary": "Get Metrics",
                "operationId": "get_metrics_metrics_get",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Cache metrics",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "tenant": {
                              "type": "string",
                              "example": "test"
                            },
                            "requests": {
                              "type": "integer",
                              "example": 100
                            },
                            "hits": {
                              "type": "integer",
                              "example": 60
                            },
                            "semantic_hits": {
                              "type": "integer",
                              "example": 20
                            },
                            "misses": {
                              "type": "integer",
                              "example": 40
                            },
                            "hit_ratio": {
                              "type": "number",
                              "example": 0.6
                            },
                            "sim_threshold": {
                              "type": "number",
                              "example": 0.83
                            },
                            "entries": {
                              "type": "integer",
                              "example": 50
                            },
                            "p50_latency_ms": {
                              "type": "number",
                              "example": 947.68
                            },
                            "p95_latency_ms": {
                              "type": "number",
                              "example": 4034.67
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized - Missing or invalid API key"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Simple Query",
        "description": "Query endpoint with semantic caching",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "paths": {
            "/query": {
              "get": {
                "summary": "Simple Query",
                "operationId": "simple_query_query_get",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "prompt",
                    "in": "query",
                    "required": true,
                    "schema": {
                      "type": "string"
                    },
                    "example": "What is Python?"
                  },
                  {
                    "name": "model",
                    "in": "query",
                    "required": false,
                    "schema": {
                      "type": "string",
                      "default": "gpt-4o-mini"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Query response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "answer": {
                              "type": "string"
                            },
                            "meta": {
                              "type": "object",
                              "properties": {
                                "hit": {
                                  "type": "string",
                                  "enum": [
                                    "exact",
                                    "semantic",
                                    "miss"
                                  ]
                                },
                                "similarity": {
                                  "type": "number"
                                },
                                "latency_ms": {
                                  "type": "number"
                                },
                                "strategy": {
                                  "type": "string"
                                }
                              }
                            },
                            "metrics": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "500": {
                    "description": "Internal server error"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "OpenAI-Compatible Chat Completions",
        "description": "OpenAI-compatible chat completions endpoint with semantic caching",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "paths": {
            "/v1/chat/completions": {
              "post": {
                "summary": "Chat completions endpoint",
                "operationId": "openai_compatible_v1_chat_completions_post",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "messages"
                        ],
                        "properties": {
                          "model": {
                            "type": "string",
                            "default": "gpt-4o-mini"
                          },
                          "messages": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "role": {
                                  "type": "string",
                                  "enum": [
                                    "user",
                                    "assistant",
                                    "system"
                                  ]
                                },
                                "content": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "role",
                                "content"
                              ]
                            }
                          },
                          "temperature": {
                            "type": "number",
                            "default": 0.2
                          },
                          "ttl_seconds": {
                            "type": "integer",
                            "default": 604800
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Chat completion response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "object": {
                              "type": "string"
                            },
                            "created": {
                              "type": "integer"
                            },
                            "model": {
                              "type": "string"
                            },
                            "choices": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              }
                            },
                            "usage": {
                              "type": "object"
                            },
                            "meta": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "500": {
                    "description": "Internal server error"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
