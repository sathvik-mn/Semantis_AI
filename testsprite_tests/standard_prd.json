{
  "meta": {
    "project": "Semantis AI Semantic Caching Platform",
    "date": "2025-11-04",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "Semantis AI is a SaaS platform providing a developer-friendly semantic caching layer for large language model (LLM) applications. It reduces LLM cost and latency by caching semantically equivalent prompts and reusing answers through a hybrid exact and semantic caching approach, with support for multi-tenant isolation, real-time observability, and OpenAI-compatible API endpoints.",
  "core_goals": [
    "Deliver a zero-infrastructure, developer-first caching layer compatible with OpenAI APIs.",
    "Achieve 50-70% cache hit rates on typical LLM workloads within 30 days.",
    "Provide transparent observability through rich metrics, hit ratios, similarity scores, and cost savings.",
    "Support multi-tenant isolation with secure API key authentication.",
    "Offer pluggable vector store backends (initially FAISS, with pgvector/Redis/Milvus planned)."
  ],
  "key_features": [
    "OpenAI-compatible chat completions endpoint with semantic caching and detailed meta data (hit type, similarity, latency).",
    "Simple query endpoint for fast semantic cache lookups.",
    "Hybrid cache mechanism combining exact match and semantic similarity using vector embeddings.",
    "Adaptive per-tenant similarity threshold tuning to maintain target cache hit windows.",
    "Tenant-isolated cache data with API-key based authentication for security.",
    "Comprehensive logging (access, semantic operations, errors) and rotating logs.",
    "Observability endpoints providing cache metrics, recent cache events, and system health status.",
    "Developer SDKs for Python and Node.js with retry/backoff logic.",
    "Admin APIs for cache invalidation and threshold tuning (planned future).",
    "Frontend dashboard for metrics visualization, query playground, logs viewer, and tenant settings management."
  ],
  "user_flow_summary": [
    "Developer integrates SDK or directly calls OpenAI-compatible /v1/chat/completions API with tenant API key.",
    "System checks exact cache for prompt and model match; returns cached response if hit.",
    "If exact miss, system searches semantic cache via vector similarity; returns best match if similarity exceeds tenant-specific threshold.",
    "If no suitable semantic hit, queries upstream LLM and caches response with embeddings.",
    "Metrics and events captured per request for observability and adaptive threshold adjustment.",
    "Tenant user accesses frontend dashboard to monitor metrics, run queries, view logs, and configure tenant parameters.",
    "Backend health and readiness endpoints provide service status to operations teams."
  ],
  "validation_criteria": [
    "All API requests must include valid tenant API key and return responses with structured meta info indicating cache hit status (exact, semantic, miss).",
    "Exact cache hits for identical prompts within sessions are verified.",
    "Semantic cache hits occur for paraphrased prompts meeting or exceeding similarity thresholds.",
    "TTL and popularity-based cache entry expiration and extension are correctly enforced.",
    "Logs are created for every request, error, and semantic cache operation with rotation policies.",
    "Metrics endpoint accurately reflects cache performance statistics corresponding to logs.",
    "Cache invalidation through admin API removes specified entries without system crashes or index corruption.",
    "Adaptive similarity threshold adjusts within target hit ratio bounds per tenant based on traffic.",
    "Frontend query playground displays correct hit/miss status and similarity for each request.",
    "Dashboard metrics and logs update appropriately after each relevant interaction.",
    "Sample SDKs function correctly with network tolerance and retry mechanisms."
  ],
  "code_summary": {
    "tech_stack": [
      "Python",
      "FastAPI",
      "FAISS",
      "OpenAI",
      "Uvicorn"
    ],
    "features": [
      {
        "name": "Health Check",
        "description": "Returns service health status",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "openapi": "3.1.0",
          "info": {
            "title": "Semantis AI Semantic Cache API",
            "description": "A semantic caching service for LLM apps. Authentication via Bearer API keys formatted as `Bearer sc-{tenant}-{anything}`.",
            "version": "0.1.0"
          },
          "components": {
            "securitySchemes": {
              "BearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "sc-{tenant}-{anything}",
                "description": "Use tenant-based auth keys (e.g., Bearer sc-test-local)"
              }
            }
          },
          "security": [
            {
              "BearerAuth": []
            }
          ],
          "paths": {
            "/health": {
              "get": {
                "summary": "Health",
                "operationId": "health_health_get",
                "responses": {
                  "200": {
                    "description": "Successful Response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "status": {
                              "type": "string",
                              "example": "ok"
                            },
                            "service": {
                              "type": "string",
                              "example": "semantic-cache"
                            },
                            "version": {
                              "type": "string",
                              "example": "0.1.0"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Cache Metrics",
        "description": "Returns cache performance metrics for a tenant",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "paths": {
            "/metrics": {
              "get": {
                "summary": "Get Metrics",
                "operationId": "get_metrics_metrics_get",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Cache metrics",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "tenant": {
                              "type": "string",
                              "example": "test"
                            },
                            "requests": {
                              "type": "integer",
                              "example": 100
                            },
                            "hits": {
                              "type": "integer",
                              "example": 60
                            },
                            "semantic_hits": {
                              "type": "integer",
                              "example": 20
                            },
                            "misses": {
                              "type": "integer",
                              "example": 40
                            },
                            "hit_ratio": {
                              "type": "number",
                              "example": 0.6
                            },
                            "sim_threshold": {
                              "type": "number",
                              "example": 0.83
                            },
                            "entries": {
                              "type": "integer",
                              "example": 50
                            },
                            "p50_latency_ms": {
                              "type": "number",
                              "example": 947.68
                            },
                            "p95_latency_ms": {
                              "type": "number",
                              "example": 4034.67
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized - Missing or invalid API key"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Simple Query",
        "description": "Query endpoint with semantic caching",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "paths": {
            "/query": {
              "get": {
                "summary": "Simple Query",
                "operationId": "simple_query_query_get",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "parameters": [
                  {
                    "name": "prompt",
                    "in": "query",
                    "required": true,
                    "schema": {
                      "type": "string"
                    },
                    "example": "What is Python?"
                  },
                  {
                    "name": "model",
                    "in": "query",
                    "required": false,
                    "schema": {
                      "type": "string",
                      "default": "gpt-4o-mini"
                    }
                  }
                ],
                "responses": {
                  "200": {
                    "description": "Query response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "answer": {
                              "type": "string"
                            },
                            "meta": {
                              "type": "object",
                              "properties": {
                                "hit": {
                                  "type": "string",
                                  "enum": [
                                    "exact",
                                    "semantic",
                                    "miss"
                                  ]
                                },
                                "similarity": {
                                  "type": "number"
                                },
                                "latency_ms": {
                                  "type": "number"
                                },
                                "strategy": {
                                  "type": "string"
                                }
                              }
                            },
                            "metrics": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "500": {
                    "description": "Internal server error"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "OpenAI-Compatible Chat Completions",
        "description": "OpenAI-compatible chat completions endpoint with semantic caching",
        "files": [
          "backend/semantic_cache_server.py"
        ],
        "api_doc": {
          "paths": {
            "/v1/chat/completions": {
              "post": {
                "summary": "Chat completions endpoint",
                "operationId": "openai_compatible_v1_chat_completions_post",
                "security": [
                  {
                    "BearerAuth": []
                  }
                ],
                "requestBody": {
                  "required": true,
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "required": [
                          "messages"
                        ],
                        "properties": {
                          "model": {
                            "type": "string",
                            "default": "gpt-4o-mini"
                          },
                          "messages": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "role": {
                                  "type": "string",
                                  "enum": [
                                    "user",
                                    "assistant",
                                    "system"
                                  ]
                                },
                                "content": {
                                  "type": "string"
                                }
                              },
                              "required": [
                                "role",
                                "content"
                              ]
                            }
                          },
                          "temperature": {
                            "type": "number",
                            "default": 0.2
                          },
                          "ttl_seconds": {
                            "type": "integer",
                            "default": 604800
                          }
                        }
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Chat completion response",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "object": {
                              "type": "string"
                            },
                            "created": {
                              "type": "integer"
                            },
                            "model": {
                              "type": "string"
                            },
                            "choices": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              }
                            },
                            "usage": {
                              "type": "object"
                            },
                            "meta": {
                              "type": "object"
                            }
                          }
                        }
                      }
                    }
                  },
                  "401": {
                    "description": "Unauthorized"
                  },
                  "500": {
                    "description": "Internal server error"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
